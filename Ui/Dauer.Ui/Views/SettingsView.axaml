<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Dauer.Ui.ViewModels"
             xmlns:views="clr-namespace:Dauer.Ui.Views"
             xmlns:controls="using:Dauer.Ui.Controls"
             xmlns:converters="using:Dauer.Ui.Converters"
             mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
             x:Class="Dauer.Ui.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">
  <Design.DataContext>
    <vm:DesignSettingsViewModel />
  </Design.DataContext>

  <UserControl.Styles>
    <StyleInclude Source="../Styles.axaml"/>
  </UserControl.Styles>

  <UserControl.Resources>
    <ResourceDictionary>
      <converters:BooleanToColorConverter x:Key="BooleanToColorConverter" TrueColor="{StaticResource FitGreenCrayonBrush}" FalseColor="{StaticResource FitRedCrayonBrush}"/>
      <converters:BooleanToStringConverter x:Key="BooleanToStringConverter" />
    </ResourceDictionary>
  </UserControl.Resources>

  <ScrollViewer>
    <StackPanel Orientation="Vertical">

      <WrapPanel Margin="0,10,0,10">
        <TextBlock Text="Login Status:" Width="150" VerticalAlignment="Center"/>
        <Ellipse Fill="{Binding FitEdit.IsAuthenticated, Converter={StaticResource BooleanToColorConverter}}"
                 Margin="10,0,10,0"
                 Width="10" Height="10">
        </Ellipse>
        <TextBlock Text="{Binding FitEdit.IsAuthenticated, Converter={StaticResource BooleanToStringConverter}, ConverterParameter='Signed out'}" VerticalAlignment="Center" Margin="10,0,10,0"/>
      </WrapPanel>

      <WrapPanel Margin="0,10,0,10">
        <TextBlock Text="Username: " Width="150" VerticalAlignment="Center"/>
        <TextBox Text="{Binding FitEdit.Username, Mode=TwoWay}" VerticalAlignment="Center" Margin="10,0,10,0" Width="240"/>
        <Button Command="{Binding HandleLoginClicked}" Content="Sign In" IsVisible="{Binding !FitEdit.IsAuthenticated}"/>
        <Button Command="{Binding HandleLogoutClicked}" Content="Sign Out" IsVisible="{Binding FitEdit.IsAuthenticated}"/>
      </WrapPanel>

      <WrapPanel Margin="0,10,0,10" IsVisible="{Binding FitEdit.IsAuthenticating}">
        <TextBlock Text="Enter code: " Width="150" VerticalAlignment="Center"/>
        <TextBox Text="{Binding Otp, Mode=TwoWay}" IsVisible="{Binding FitEdit.IsAuthenticating}" VerticalAlignment="Center" Margin="10,0,10,0" MinWidth="240"/>
        <Button Command="{Binding HandleVerifyEmailClicked}" Content="Verify"/>
      </WrapPanel>

      <WrapPanel Margin="0,10,0,10" IsVisible="{Binding FitEdit.IsAuthenticated}">
        <TextBlock Text="Payment status:" Width="150" VerticalAlignment="Center"/>
        <StackPanel Orientation="Horizontal" Width="240" Margin="10,0,10,0">
          <Ellipse Fill="{Binding FitEdit.IsActive, Converter={StaticResource BooleanToColorConverter}}"
                   Width="10" Height="10">
          </Ellipse>
          <TextBlock Text="{Binding FitEdit.IsActive, Converter={StaticResource BooleanToStringConverter}, ConverterParameter='Evaluation Mode'}" VerticalAlignment="Center" Margin="10,0,10,0"/>
        </StackPanel>
        <Button Command="{Binding HandleManagePaymentsClicked}" Content="Manage Payments" IsVisible="{Binding FitEdit.IsActive}"/>
        <Button Command="{Binding HandleSignUpClicked}" Content="Sign Up" IsVisible="{Binding !FitEdit.IsActive}"/>
      </WrapPanel>

      <WrapPanel Margin="0,10,0,10" IsVisible="{Binding FitEdit.IsActive}">
        <TextBlock Text="Garmin Status:" Width="150" VerticalAlignment="Center"/>
        <StackPanel Orientation="Horizontal" Width="240" Margin="10,0,10,0">
          <Ellipse Fill="{Binding FitEdit.IsAuthenticatedWithGarmin, Converter={StaticResource BooleanToColorConverter}}"
                   Width="10" Height="10">
          </Ellipse>
          <TextBlock Text="{Binding FitEdit.IsAuthenticatedWithGarmin, Converter={StaticResource BooleanToStringConverter}, ConverterParameter='Signed out'}" VerticalAlignment="Center" Margin="10,0,10,0"/>
        </StackPanel>
        <Button Command="{Binding HandleGarminAuthorizeClicked}" Content="Authorize with Garmin" IsVisible="{Binding !FitEdit.IsAuthenticatedWithGarmin}"/>
        <Button Command="{Binding HandleGarminDeauthorizeClicked}" Content="Deauthorize with Garmin" IsVisible="{Binding FitEdit.IsAuthenticatedWithGarmin}"/>
      </WrapPanel>

      <WrapPanel Margin="0,10,0,10" IsVisible="{Binding FitEdit.IsActive}">
        <TextBlock Text="Strava Status:" Width="150" VerticalAlignment="Center"/>
        <StackPanel Orientation="Horizontal" Width="240" Margin="10,0,10,0">
          <Ellipse Fill="{Binding FitEdit.IsAuthenticatedWithStrava, Converter={StaticResource BooleanToColorConverter}}"
                   Width="10" Height="10">
          </Ellipse>
          <TextBlock Text="{Binding FitEdit.IsAuthenticatedWithStrava, Converter={StaticResource BooleanToStringConverter}, ConverterParameter='Signed out'}" VerticalAlignment="Center" Margin="10,0,10,0"/>
        </StackPanel>
        <Button Command="{Binding HandleStravaAuthorizeClicked}" Content="Authorize with Strava" IsVisible="{Binding !FitEdit.IsAuthenticatedWithStrava}"/>
        <!--<Button Command="{Binding HandleStravaDeauthorizeClicked}" Content="Deauthorize with Strava" IsVisible="{Binding FitEdit.IsAuthenticatedWithStrava}"/>-->
      </WrapPanel>
      
      <TextBlock Text="{Binding Message}" Margin="0,10,0,10" Width="300" TextWrapping="Wrap"/>
    </StackPanel>
  </ScrollViewer>

</UserControl>
